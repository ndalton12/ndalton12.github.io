{"componentChunkName":"component---src-templates-blog-post-jsx","path":"/blog/llm-arithmetic/","result":{"data":{"site":{"siteMetadata":{"name":"Niall Dalton","title":"Niall Dalton","description":"I write code and think about stuff.","about":"\nCurrently, I am an Applied AI Engineer at Scale AI. I like physics, technology, and philosophy.\nPreviously, I worked at Amazon on embedded software for Project Kuiper, a satellite internet constellation.\nI also did research and ML projects at Activ Surgical, Northeastern University, and MIT Lincoln Lab.\n\nIf you're interested, here is my [resume](./resume.pdf). Better yet, here is a picture of my [dog](/tucker.jpg).\n\nHere are a random assortment of things I find interesting: \n* [Neuroscience of Free Will](https://en.wikipedia.org/wiki/Neuroscience_of_free_will)\n* [r/ErgoMechKeyboards](https://www.reddit.com/r/ErgoMechKeyboards/)\n* [Bell's Theorem](https://en.wikipedia.org/wiki/Bell%27s_theorem)\n* [Gödel's Incompleteness Theorems](https://en.wikipedia.org/wiki/G%C3%B6del%27s_incompleteness_theorems)\n* [Quanta Magazine](https://www.quantamagazine.org/)\n* [Golem XIV](https://rtraba.files.wordpress.com/2017/01/golem-xiv.pdf)\n* [Programming stories](https://thedailywtf.com/)\n* [My favorite internet blog](https://gwern.net/index)\n","author":null,"github":"https://github.com/ndalton12","linkedin":"https://www.linkedin.com/in/niall-dalton/"}},"markdownRemark":{"id":"d712ab4a-7410-5c94-b0e5-0c8c1dfff491","excerpt":"TLDR: “Reasoning” LLMs cannot actually apply algorithms to arbitrary lengths of data through chain of thought, even when they should have enough tokens to do so…","html":"<p><strong>TLDR</strong>: “Reasoning” LLMs cannot actually apply algorithms to arbitrary lengths of data through chain of thought, even when they should have enough tokens to do so; rather, they likely rely on a set of heuristics which breakdown on high difficulty or long length problems. Moreover, these models even appear to “give up” past a certain difficulty and emit less thinking tokens than on easier problems of the same type! A recent paper from Apple showed this behavior; here, we replicate the results using simple n-digit multiplication.</p>\n<h1>The Illusion of Thinking</h1>\n<p>The recent paper <a href=\"https://machinelearning.apple.com/research/illusion-of-thinking\">“The Illusion of Thinking: Understanding the Strengths and Limitations of Reasoning Models via the Lens of Problem Complexity”</a> show that “LRMs have limitations in exact computation: they fail to use explicit algorithms and reason inconsistently across puzzles” and call into question the ability of Reasoning LLMs, a.k.a Large Reasoning Models (LRMs), to actually think, particularly in the algorithmic sense. The paper also makes an interesting discovery: reasoning effort increases with problem complexity up to a certain point, then decreases, despite adequate budget.</p>\n<p>I replicated some of the results of the paper on simple multiplication problems, by varying the digit length (n x n) of the problem and the allowed thinking budget for Claude 3.7 Sonnet. The experiment itself is dead simple but the results corroborate much of the paper’s findings. The results are shown in the figure below.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; margin: 0 0 30px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/259e80611252c0d0e14e7dd25ece5783/985a9/Figure_1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.10810810810811%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAA9hAAAPYQGoP6dpAAACg0lEQVR42k1SS2sUQRBewT/hxZuCB0EURBAxQbxF8BTwoCJeRBTxEFBcg4iIEA1KkmsOPkgIAfGieEkgIFGPmV1WghhicJPdnZ1Hz/b0Y2b2s6rHTSymmZ7q6prvURWVpvDbbTR/b9C7gzCK4Ps+er0esiyDSBIEQQARC3CsLK5iauwtph/OYXp8HjPVBcxPLUP2frnzilbKbaKoBdlpA333iT69jUqx8XMda56Heq3u8o+vPMex/Zdw7vA9DB26j5NHxnB1tApv+yvfQkVK6QpTYxB2mhDbLRRFgTzPYa2FkikSQpmIBJTFxLUpDB+8jZGLr3D21kucWajiiXcDy5setLaopESZQ9scPRki6QbItCGEfUe5hEtPUUKfuD6D4QM3MXLhBU5VJ3H+0118XB/FasODUtRQEeUSUUEJiThsIW75kITKEOqSfh95lpeUL0/ixD6ifPwRTg89w9Gn43jw/g5Wv6zRT0lDvsRLErWddhfNNjUMfYhuCGssBsFNOdZW6vgwu4TFN0t4N7eE15+/Y/ZbHTvNoDSFdWKEPUIURSHCbpf2AgU14LMwjtDplO7nJIElbU2RI9EShlZuNVQSI6Y6rXVJmSMzGoZQZpYu0QGbYnTpsler4Uej4UZJKe3kkZrOs8Lpm5O+DIqZEmXr6GhF1CWtUNA+I3cVNbdE2yCln3KxEAIDE3NqIFLjGjEb7vGvITlKSRUnsDJBnkoURkF2I5pDvesyB7MZMOJBdZOh7W6Ba8jcd/5sIdjeghQ+4qRDhjQRtDcJabo35RSMhnViNLwfjFtC48L0NY1bhQsEaSc1G0DG0ABLOuAcm/J/DGhxnpfTlCRQVB+TRNoY/AVKu2+TfdymbwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"figure 1\"\n        title=\"\"\n        src=\"/static/259e80611252c0d0e14e7dd25ece5783/fcda8/Figure_1.png\"\n        srcset=\"/static/259e80611252c0d0e14e7dd25ece5783/12f09/Figure_1.png 148w,\n/static/259e80611252c0d0e14e7dd25ece5783/e4a3f/Figure_1.png 295w,\n/static/259e80611252c0d0e14e7dd25ece5783/fcda8/Figure_1.png 590w,\n/static/259e80611252c0d0e14e7dd25ece5783/efc66/Figure_1.png 885w,\n/static/259e80611252c0d0e14e7dd25ece5783/c83ae/Figure_1.png 1180w,\n/static/259e80611252c0d0e14e7dd25ece5783/985a9/Figure_1.png 1512w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>From the results, we see a few things. First, we can see that accuracy falls off abruptly as digit length increases and that increasing the thinking budget tends to right-shift the curve — but the curve’s shape tends to stay more or less the same. In the bottom left graph we can see the “giving up” behavior where tokens used initially increases, but eventually steeply falls off past a certain point. This is more pronounced for the larger thinking budgets (although budget=4096 shows this the best). Since we can only increase the digit length by integer amounts, the curves aren’t perfectly smooth, and the highest thinking budget tested (16834) does show some deviation from this behavior, although the overall shape is still similar. Likewise, the response time graph in the top right closely mirrors the token usage, as to be expected (since more tokens used means more response time).</p>\n<p>Something interesting to point out though is that none of the thinking budgets actually saturate the full thinking budget (outside of no thinking I suppose). For example, budget 4096 only expends up to around 3000 tokens before “giving up”. However, we can still see performance increases when upping the budget to 8192 <em>despite</em> the fact that the 8192 budget also does not exceed the previous 4096 budget! <strong>This implies that allowing the model additional thinking budget can result in better performance <em>even when it does not use the additional budget</em></strong>. Given that we don’t know the inner workings of how Claude limits its thinking budget, it’s hard to know how this mechanism works, but perhaps it is similar to <a href=\"https://arxiv.org/abs/2506.13752\">this recent paper</a>.</p>\n<p>Code for the project is <a href=\"https://github.com/ndalton12/llm-arithmetic\">here</a>. If you have the budget, feel free to fork and test with different models — the code is using LiteLLM so it should be easy to try different ones (although you may need to change the thinking parameter).</p>\n<h1>The Obviously Jagged Frontier</h1>\n<p>How can models which are pushing better and better results in mathematics competitions fail to do simple arithmetic? The idea that LLMs are incredibly smart at some things but relatively stupid at other things is known as the jagged frontier — that is, LLMs push well above average humans on some tasks and well below at others, hence creating a jagged boundary of intelligence.</p>\n<p>It’s not yet clear why LLMs behave this way, but we can speculate about their nature from the results of “The Illusion of Thinking” and the results shown here. From <a href=\"https://transformer-circuits.pub/2025/attribution-graphs/methods.html\">“Circuit Tracing”</a> we can see that Claude likely does addition through “several intermediate heuristics rather than a coherent procedural program with a single confident output.” It’s reasonable to assume that other arithmetic operations behave similarly (such as multiplication). By relying on heuristics, the models build uncertainty with each step, and perhaps recognize or are overwhelmed when needing to apply these heuristics across increasingly more digits in arithmetic problems. Or perhaps the <em>width</em> of the network limits its ability to produce coherent heuristics across larger digit inputs when applying complex, heuristic driven attention patterns.</p>\n<p>That said, I think there are many open questions in this area. If you want to discuss, feel free to contact me at <a href=\"mailto:niall.dalton12@gmail.com\">niall.dalton12@gmail.com</a>.</p>","frontmatter":{"title":"Replicating \"The Illusion of Thinking\" Paper with Simple Arithmetic","date":"June 20, 2025","description":"Do LLMs actually know how to think about arithmetic?"}}},"pageContext":{"slug":"/blog/llm-arithmetic/","previous":{"fields":{"slug":"/blog/moral-reasoning/"},"frontmatter":{"title":"Evaluating Long-Term Ethical Decision-Making Capabilities of Reasoning LLMs"}},"next":null}},"staticQueryHashes":["63159454"],"slicesMap":{}}